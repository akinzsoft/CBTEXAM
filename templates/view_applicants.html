{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Applicants for {{ scholarship.title }} |  CBT</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f5f7fb; margin: 0; padding: 0; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 1rem; }
        h1 { color: #6610f2; margin-bottom: 1rem; }
        table { width: 100%; border-collapse: collapse; background: #fff; border-radius: 0.5rem; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.07); }
        th, td { padding: 0.75rem 1rem; text-align: left; }
        th { background: #6610f2; color: white; }
        tr:nth-child(even) { background: #f2f2f2; }
        tr:hover { background: #e0d6f9; }
        .btn-back, .btn-edit, .btn-reset, .btn-delete, .btn-print, .btn-excel {
            display: inline-block;
            margin: 0.25rem;
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: 0.5rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
        }
        .btn-back { background: #6610f2; }
        .btn-edit { background: #17a2b8; }
        .btn-reset { background: #ffc107; color: black; }
        .btn-delete { background: #dc3545; }
        .btn-print { background: #28a745; }
        .btn-excel { background: #20c997; }
    </style>
</head>
<body>
    <div class="container">
        <a href="{% url 'scholarview' %}" class="btn-back">â¬… Back to Scholarships</a>
        <h1>Applicants for {{ scholarship.title }}</h1>

        <!-- Action Buttons -->
        <div style="margin-bottom: 1rem;">
            <button class="btn-print" onclick="window.print()">ðŸ–¨ Print</button>
            <button class="btn-excel" onclick="exportTableToExcel('applicantsTable', 'applicants_{{ scholarship.id }}')">â¬‡ Export to Excel</button>
            
            
        </div>
        
        <table id="applicantsTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>School</th>
                    <th>GPA</th>
                    <th>Username</th>
                    <th>Password</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
            {% if applicant_users %}
                {% for applicant in applicant_users %}
                <tr>
                    <td>{{ applicant.name|default:"N/A" }}</td>
                    <td>{{ applicant.email|default:"N/A" }}</td>
                    <td>{{ applicant.phoneno|default:"N/A" }}</td>
                    <td>{{ applicant.school_name|default:"N/A" }}</td>
                    <td>{{ applicant.gpa|default:"N/A" }}</td>
                    <td>{{ applicant.user|default:"N/A" }}</td>
                    <td>{{ applicant.plain_password|default:"N/A" }}</td>
                    <td>
                        <a href="{% url 'edit_applicant' applicant.id %}" class="btn-edit">Edit</a>
                        <a href="{% url 'reset_applicant_password' applicant.user %}" class="btn-reset">Reset Password</a>
                        <a href="{% url 'delete_applicant' applicant.id %}" class="btn-delete" onclick="return confirm('Are you sure you want to delete this applicant?');">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="8" style="text-align:center;">No applicants yet</td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>

    <script>
        // Export table to Excel
        function exportTableToExcel(tableID, filename = '') {
            var dataType = 'application/vnd.ms-excel';
            var tableSelect = document.getElementById(tableID);
            var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');

            filename = filename?filename+'.xls':'excel_data.xls';

            var downloadLink = document.createElement("a");
            document.body.appendChild(downloadLink);

            if(navigator.msSaveOrOpenBlob){
                var blob = new Blob(['\ufeff', tableHTML], { type: dataType });
                navigator.msSaveOrOpenBlob( blob, filename);
            } else {
                downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
                downloadLink.download = filename;
                downloadLink.click();
            }
        }
    </script>
</body>
</html>
